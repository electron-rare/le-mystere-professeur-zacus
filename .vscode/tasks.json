{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Zacus: Firmware · Bootstrap venv",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "./tools/dev/bootstrap_local.sh"],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus", "reveal": "always" }
    },
    {
      "label": "Zacus: Firmware · Build all (build_all.sh)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "./tools/dev/bootstrap_local.sh && export PLATFORMIO_CORE_DIR=\"$HOME/.platformio\" && ./build_all.sh"
      ],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus", "reveal": "always" }
    },
    {
      "label": "Zacus: Firmware · RC live (require HW)",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "./tools/dev/zacus.sh rc"],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus", "reveal": "always" }
    },
    {
      "label": "Zacus: Firmware · Codex Overhaul",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "./tools/dev/zacus.sh codex --prompt tools/dev/codex_prompts/zacus_overhaul_one_shot.md"
      ],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus", "reveal": "always" }
    },
    {
      "label": "Zacus: Firmware · Ports watch (15s)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "while true; do printf '==== %s ====\\n' \"$(date)\"; ./tools/dev/zacus.sh ports; sleep 15; done"
      ],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus-watch", "reveal": "always" }
    },
    {
      "label": "Zacus: Firmware · Tail last RC log (5s)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "while true; do d=$(ls -1dt artifacts/rc_live/* 2>/dev/null | head -n 1); if [ -n \"$d\" ]; then echo \"== $d ==\"; tail -n 60 \"$d/run_matrix_and_smoke.log\" 2>/dev/null || true; echo; fi; sleep 5; done"
      ],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus-watch", "reveal": "always" }
    },
    {
      "label": "Zacus: Firmware · Show last summary",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "d=$(ls -1dt artifacts/rc_live/* 2>/dev/null | head -n 1); echo \"Last: ${d:-n/a}\"; [ -n \"$d\" ] && sed -n '1,220p' \"$d/summary.md\" || true"
      ],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus", "reveal": "always" }
    },
    {
      "label": "Zacus: Cockpit (ports + tail)",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "echo \"Cockpit started (stop tasks to close watchers).\""],
      "options": { "cwd": "${workspaceFolder}/hardware/firmware" },
      "dependsOrder": "parallel",
      "dependsOn": [
        "Zacus: Firmware · Ports watch (15s)",
        "Zacus: Firmware · Tail last RC log (5s)"
      ],
      "problemMatcher": [],
      "presentation": { "panel": "dedicated", "group": "zacus", "reveal": "always" }
    }
  ]
}
