{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Zacus: List ports (15s, venv strict)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "set -e; ROOT='${workspaceFolder}'; if [ -f \"$ROOT/platformio.ini\" ]; then FW=\"$ROOT\"; else FW=\"$ROOT/hardware/firmware\"; fi; cd \"$FW\"; test -f .venv/bin/activate || { echo 'Missing venv: run tools/dev/bootstrap_local.sh'; exit 1; }; source .venv/bin/activate; while true; do echo \"\\n=== PORTS $(date) ===\"; python3 -m serial.tools.list_ports -v; sleep 15; done"
      ],
      "presentation": { "panel": "dedicated", "reveal": "always", "clear": true, "group": "zacus" },
      "problemMatcher": []
    },
    {
      "label": "Zacus: Serial smoke (auto/skip)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "set -e; ROOT='${workspaceFolder}'; if [ -f \"$ROOT/platformio.ini\" ]; then FW=\"$ROOT\"; else FW=\"$ROOT/hardware/firmware\"; fi; cd \"$FW\"; test -f .venv/bin/activate || { echo 'Missing venv: run tools/dev/bootstrap_local.sh'; exit 1; }; source .venv/bin/activate; python3 tools/dev/serial_smoke.py --role auto --baud 19200 --wait-port 3 --allow-no-hardware"
      ],
      "presentation": { "panel": "dedicated", "reveal": "always", "clear": true, "group": "zacus" },
      "problemMatcher": []
    },
    {
      "label": "Zacus: Matrix + smoke (one-shot)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "set -e; ROOT='${workspaceFolder}'; if [ -f \"$ROOT/platformio.ini\" ]; then FW=\"$ROOT\"; else FW=\"$ROOT/hardware/firmware\"; fi; cd \"$FW\"; test -f .venv/bin/activate && source .venv/bin/activate || true; ./tools/dev/run_matrix_and_smoke.sh"
      ],
      "presentation": { "panel": "dedicated", "reveal": "always", "clear": true, "group": "zacus" },
      "problemMatcher": []
    }
  ]
}
